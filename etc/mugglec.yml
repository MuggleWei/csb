task-local-linux:
  mode: local
  scripts:
    - git clone --depth=1 --branch=${GIT_TAG} https://github.com/MuggleWei/mugglec.git
    - mkdir -p ${BP_ROOT_DIR}/build
    - > cmake
        -S ${BP_ROOT_DIR}
        -B ${BP_ROOT_DIR}/build
        -DCMAKE_BUILD_TYPE=${BUILD_TYPE}
        -DBUILD_SHARED_LIBS=ON
        -DCMAKE_INSTALL_PREFIX=${BP_ROOT_DIR}/usr
    - cmake --build ${BP_ROOT_DIR}/build --target install
    - cd ${BP_ROOT_DIR}/usr
    - tar -czvf mugglec-${GIT_TAG}-${BUILD_TYPE}.tar.gz ./*
    - mv mugglec-${GIT_TAG}-${BUILD_TYPE}.tar.gz ${BP_OUTPUT_DIR}
